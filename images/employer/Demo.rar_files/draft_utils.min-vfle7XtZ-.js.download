define(["require","exports","draft-js","punycode","immutable"],function(e,t,n,r,o){"use strict";function c(e){return 0===e.getCurrentContent().getPlainText().length}function a(e){return e.getSelection().getHasFocus()}function i(e,t){return n.EditorState.forceSelection(n.EditorState.push(e,t,"insert-fragment"),t.getSelectionAfter())}function u(e,t,r,o,c,a){return n.Modifier.replaceText(e,n.SelectionState.createEmpty(t).merge({anchorOffset:r,focusOffset:o}),c,void 0,a)}function l(e,t,n){for(var r,o,c,a=t.getText();null!==(r=e.exec(a));)o=r.index,c=r[0].length,a=a.substring(o+c),n(o,o+c)}function f(e,r){var o=null,c=null,a=e.start,i=e.end,u=null,l=null,f=0;if(r.getBlockMap().forEach(function(e,n){if(e&&"atomic"!==e.getType()){var r=t.decodeUnicode(e.getText());if(n&&null===o&&a<f+r.length){o=n;var g=a-f;u=t.encodeUnicode(r.slice(0,g)).length}if(n&&null===c&&i<=f+r.length){c=n;var g=i-f;l=t.encodeUnicode(r.slice(0,g)).length}f+=r.length}return o&&c}),!o||!c)throw"Bad range";return n.SelectionState.createEmpty(o).merge({anchorKey:o,anchorOffset:u,focusKey:c,focusOffset:l})}function g(e){return e.match(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}function d(e){if("img"===e.tagName.toLowerCase()){var t=e.getAttribute("data-emoji-ch");if(t){var n=document.createElement("span");return n.textContent=t,n}}return e}function s(e){var t=e.style,n=e.tagName.toLowerCase(),r=[];return(parseInt(t.fontWeight||"0")>=600||"bold"===t.fontWeight||"b"===n||"strong"===n)&&(r=r.concat(["BOLD"])),"underline"!==t.textDecoration&&"u"!==n||(r=r.concat(["UNDERLINE"])),"strikethrough"!==t.textDecoration&&"s"!==n&&"strike"!==n||(r=r.concat(["STRIKETHROUGH"])),"italic"!==t.fontStyle&&"i"!==n&&"em"!==n||(r=r.concat(["ITALIC"])),r}function y(e,t,n){if(e.hasAttribute("data-entity-key")&&e.getAttribute("data-editor")===n){var r=e.getAttribute("data-entity-key");try{return t.getEntity(r),r}catch(e){return null}}}function h(e){var t=e.html,r=e.contentState,c=e.editorKey,a=e.elementMappers,i=void 0===a?[]:a,u=document.createElement("body");u.innerHTML=t;var l=[],f=u.textContent||"",g=Array(f.length),d=[0,0],h="",p=function(e){void 0===e&&(e="unstyled");var t=g.slice(d[0],d[1]);l=l.concat([(new n.ContentBlock).merge({type:e,key:n.genKey(),text:h,characterList:o.List(t)})]),h="",d=[d[1],d[1]]},m=function(e){return function(t){switch(t.nodeType){case Node.TEXT_NODE:if(t.textContent){var a=n.CharacterMetadata.create(e),u=t.textContent;h+=u;for(var l=0;l<u.length;l++,d[1]++)g[d[1]]=a}break;case Node.ELEMENT_NODE:var f=i.reduce(function(e,t){return t(e)},t);if(f.childNodes.length){var S=e?e.style.toArray():[],E=e?e.entity:null,v=f.tagName.toLowerCase(),C="true"===f.getAttribute("data-block")||["p","li","blockquote","pre"].concat([1,2,3,4,5,6].map(function(e){return"h"+e})).indexOf(v)!==-1;S=S.concat(s(f)),E=y(f,r,c)||E;var k={style:o.OrderedSet(S)};E&&(k.entity=E),Array.from(f.childNodes).forEach(m(k)),C&&p()}}}};return Array.from(u.childNodes).forEach(m()),0===l.length&&p(),o.OrderedMap(l.map(function(e){return[e.getKey(),e]}))}function p(e){var t=e.getSelection(),n=e.getCurrentContent(),r=t.getStartKey(),o=t.getEndKey(),c=n.getBlockMap();return c.toSeq().skipUntil(function(e,t){return t===r}).takeUntil(function(e,t){return t===o}).concat([[o,c.get(o)]]).toList()}function m(e){var t={BOLD:!1,ITALIC:!1,UNDERLINE:!1,STRIKETHROUGH:!1},n=e.getSelection(),r=e.getCurrentContent(),o=n.getStartOffset(),c=r.getBlockForKey(n.getStartKey());return(n.isCollapsed()?e.getCurrentInlineStyle().toList().toJS():c.getInlineStyleAt(o).toArray()).forEach(function(e){e in t&&(t[e]=!0)}),t}function S(e){var t=p(e),n=null;return t.forEach(function(e){if(e){var t=e.getType();if(null===n)n=t;else if(n!==t)return n=null,!1}}),n||"unstyled"}Object.defineProperty(t,"__esModule",{value:!0}),t.contentIsEmpty=c,t.hasFocus=a,t.replaceContent=i,t.replaceText=u,t.findWithRegex=l,t.locationToSelection=f,t.parseEmail=g,t.decodeUnicode=function(e){return r.ucs2.decode(e)},t.encodeUnicode=function(e){return r.ucs2.encode(e)},t.paperEmojiMapper=d,t.htmlToFragment=h,t.mergeBlockDataByKey=function(e,t,r,o){void 0===o&&(o=!1);var c,a=e.getCurrentContent(),i=a.getBlockForKey(t).mergeIn(["data"],r),u=a.getBlockMap().merge((c={},c[t]=i,c)),l=e.getSelection(),f=n.EditorState.push(e,a.merge({blockMap:u}),"change-block-data");return o?f:n.EditorState.acceptSelection(f,l)},t.getSelectedBlocksList=p,t.getSelectionInlineStyle=m,t.getSelectionBlockTypes=S});
//# sourceMappingURL=draft_utils.min.js-vflRRm0n0.map